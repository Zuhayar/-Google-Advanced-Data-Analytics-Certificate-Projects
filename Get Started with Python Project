import numpy as np
import pandas as pd
# RUN THIS CELL TO IMPORT YOUR DATA.
df = pd.read_csv('2017_Yellow_Taxi_Trip_Data.csv')
print("done")

df.head(10)
df.info()
df.describe()

# Sort the data by trip distance from maximum to minimum value
df_sort = df.sort_values(by='trip_distance',ascending=False)
df_sort.head(10)

total_amount_sorted = df.sort_values(by='total_amount',ascending=False)[['total_amount']]
# Sort the data by total amount and print the top 20 values
total_amount_sorted.head(20)

# How many of each payment type are represented in the data?
df['payment_type'].value_counts()

# What is the average tip for trips paid for with credit card?
avg_tip_cc = df[df['payment_type']==1]['tip_amount'].mean()
print(avg_tip_cc)

# What is the average tip for trips paid for with cash?
avg_tip_cash = df[df['payment_type'] == 2]['tip_amount'].mean()
print(avg_tip_cash)


[df['payment_type']==1]

# How many times is each vendor ID represented in the data?
df['VendorID'].value_counts()

# What is the mean total amount for each vendor?
df.groupby(['VendorID']).mean(numeric_only=True)[['total_amount']]

# Filter the data for credit card payments only
credit_card = df[df['payment_type'] == 1]



# Filter the data for passenger count only
credit_card['passenger_count'].value_counts()

#passenger_count = df['passenger_count']
#passenger_count.value_counts()

# Calculate the average tip amount for each passenger count (credit card payments only)
credit_card.groupby(['passenger_count']).mean(numeric_only=True)[['tip_amount']

